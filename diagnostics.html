<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Psyche → Kink | Diagnostics</title>
  <link rel="stylesheet" href="assets/css/styles.css"/>
</head>
<body>
<header><div class="container"><strong>Diagnostics</strong></div></header>
<main class="container">
  <div class="card">
    <p>This page checks that required assets are reachable and valid JSON.</p>
    <button id="runBtn">Run Checks</button>
    <div id="out" style="margin-top:12px"></div>
  </div>
</main>
<script src="assets/js/utils.js"></script>
<script>
const files = [
  'assets/data/quiz/questions.json',
  'assets/data/quiz/dimensions.json',
  'assets/data/quiz/rules.json',
  'assets/data/quiz/archetypes.json',
  'assets/data/quiz/kink_translation.json'
];

function line(t, ok){
  const p=document.createElement('p');
  p.textContent=t;
  p.style.color = ok ? 'green' : 'crimson';
  return p;
}

document.getElementById('runBtn').onclick = async ()=>{
  const out = document.getElementById('out'); out.innerHTML='';
  for(const f of files){
    try{
      const data = await fetchJSON(f);
      out.appendChild(line(`OK: ${f}`, true));
    }catch(e){
      out.appendChild(line(`FAIL: ${f} → ${e.message}`, false));
    }
  }
  // Check quiz.js presence
  const s = document.createElement('script');
  s.src = 'assets/js/quiz.js?x=' + Math.random();
  s.onload = ()=> out.appendChild(line('OK: quiz.js loaded', true));
  s.onerror = ()=> out.appendChild(line('FAIL: quiz.js not found', false));
  document.body.appendChild(s);
};
</script>
</body>
</html>
